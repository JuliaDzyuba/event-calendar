import{dragAndDrop}from"./dragAndDrop.min.js";const selectUser=document.getElementById("userSelect"),createError=document.querySelector(".create-error"),closeBtn=document.querySelector(".btn-close"),helperText=document.querySelector(".helper-text"),createBtn=document.querySelector(".btn-create"),confirmModal=document.getElementById("confirm"),confirmText=document.querySelector(".confirm-text"),noBtn=document.querySelector(".btn-no"),yesBtn=document.querySelector(".btn-yes"),form=document.getElementById("create");let store=JSON.parse(localStorage.getItem("events"))||[];function renderEvents(e){document.querySelectorAll("td").forEach(e=>{e.innerHTML="",e.style.cssText=""}),e.forEach(e=>{const t=`td[data-id='${e.id}']`,r=document.querySelector(t);r.innerHTML=`\n      <div class="cell-wrap" draggable="true">\n        <p>${e.eventName}</p>\n        <button class="btn-delete" data-cell="${e.id}">&otimes;</button>\n      </div>\n    `,r.setAttribute("title",""+e.participants);document.querySelector(`button[data-cell='${e.id}']`).addEventListener("click",e=>{confirmModal.style.display="block";let t=e.target.previousElementSibling.textContent;confirmText.innerText=`Are you shure you want to delete "${t}" events?`,yesBtn.setAttribute("data-id",""+e.target.dataset.cell)})})}function deleteEvent(e){const t=document.querySelector(`td[data-id='${e}']`);t.innerHTML="",t.style.cssText="",store=JSON.parse(localStorage.getItem("events"))||[],store=store.filter(t=>t.id!==e),localStorage.setItem("events",JSON.stringify(store))}function getEventData(){const e=new FormData(form);let t={},r=[];for(let n of e.entries())"participants"===n[0]&&""!==n[1]?r.push(n[1]):t[n[0]]=n[1];return r.length>0?(t.participants=r,t.eventName?(helperText.style.display="",t.id=""+(t.day.toLowerCase()+t.time),delete t.day,delete t.time,void(store.find(e=>e.id===t.id)?createError.style.display="flex":(store=[...store,t],localStorage.setItem("events",JSON.stringify(store)),form.reset(),window.location.pathname=window.location.pathname.replace("create-event.html","index.html")))):(helperText.innerText="Write event name",helperText.style.color="red",void(helperText.style.display="block"))):(helperText.innerText="Choose some members",void(helperText.style.color="red"))}function sortByUser(e){renderEvents(store.filter(t=>t.participants.includes(e)))}function init(){window.location.pathname.includes("/index.html")?(renderEvents(store),dragAndDrop(),noBtn.addEventListener("click",()=>{confirmModal.style.display=""}),yesBtn.addEventListener("click",e=>{deleteEvent(e.target.dataset.id),confirmModal.style.display=""}),selectUser.addEventListener("change",()=>{let e=selectUser.value;"all"===e?renderEvents(store):sortByUser(e)})):window.location.pathname.includes("/create-event.html")&&(createBtn.addEventListener("click",e=>{e.preventDefault(),getEventData()}),closeBtn.addEventListener("click",()=>{createError.style.display=""}))}console.log("store",store),init();